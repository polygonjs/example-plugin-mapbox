import{$b as $e,C as We,Cc as I,D as Ce,Eb as Q,Fb as st,Fc as At,Ga as Z,Gb as wt,Gc as rt,Hb as he,Hc as pe,Ib as le,Jb as ce,Jc as kt,Kb as Ke,Lb as Xe,M as je,Ob as Ze,R as He,Yb as Qe,_ as re,_b as bt,ac as ti,cc as Tt,dc as yt,ec as B,fa as ne,fc as ei,ga as mt,ha as oe,ia as ae,j as ie,jc as ii,k as Le,l as Fe,lc as gt,m as Re,mc as d,na as Ge,o as se,oc as C,pc as St,qa as Je,qc as S,rc as D,sa as qe,sc as A,t as Ue,tc as vt,uc as _,vc as si,ya as Ye,zc as It}from"./chunk-OZJ2KYPB.js";var zi=0,O=class extends vt{constructor(){super();Object.defineProperty(this,"id",{value:zi++}),this.uuid=B(),this.name="",this.type="Material",this.fog=!0,this.blending=se,this.side=ie,this.vertexColors=!1,this.opacity=1,this.format=Z,this.transparent=!1,this.blendSrc=We,this.blendDst=Ce,this.blendEquation=Ue,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=je,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=$e,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bt,this.stencilZFail=bt,this.stencilZPass=bt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let i in t){let e=t[i];if(e===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===Re;continue}let s=this[i];if(s===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}s&&s.isColor?s.set(e):s&&s.isVector3&&e&&e.isVector3?s.copy(e):this[i]=e}}toJSON(t){let i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});let e={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.color&&this.color.isColor&&(e.color=this.color.getHex()),this.roughness!==void 0&&(e.roughness=this.roughness),this.metalness!==void 0&&(e.metalness=this.metalness),this.sheen!==void 0&&(e.sheen=this.sheen),this.sheenTint&&this.sheenTint.isColor&&(e.sheenTint=this.sheenTint.getHex()),this.sheenRoughness!==void 0&&(e.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(e.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(e.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(e.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(e.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(e.specularTint=this.specularTint.getHex()),this.shininess!==void 0&&(e.shininess=this.shininess),this.clearcoat!==void 0&&(e.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(e.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(e.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(e.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(e.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,e.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(e.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(e.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(e.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(e.lightMap=this.lightMap.toJSON(t).uuid,e.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(e.aoMap=this.aoMap.toJSON(t).uuid,e.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(e.bumpMap=this.bumpMap.toJSON(t).uuid,e.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(e.normalMap=this.normalMap.toJSON(t).uuid,e.normalMapType=this.normalMapType,e.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(e.displacementMap=this.displacementMap.toJSON(t).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(e.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(e.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(e.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(e.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(e.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(e.specularTintMap=this.specularTintMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(e.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(e.combine=this.combine)),this.envMapIntensity!==void 0&&(e.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(e.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(e.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(e.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(e.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(e.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(e.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(e.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(e.attenuationDistance=this.attenuationDistance),this.attenuationTint!==void 0&&(e.attenuationTint=this.attenuationTint.getHex()),this.size!==void 0&&(e.size=this.size),this.shadowSide!==null&&(e.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(e.sizeAttenuation=this.sizeAttenuation),this.blending!==se&&(e.blending=this.blending),this.side!==ie&&(e.side=this.side),this.vertexColors&&(e.vertexColors=!0),this.opacity<1&&(e.opacity=this.opacity),this.format!==Z&&(e.format=this.format),this.transparent===!0&&(e.transparent=this.transparent),e.depthFunc=this.depthFunc,e.depthTest=this.depthTest,e.depthWrite=this.depthWrite,e.colorWrite=this.colorWrite,e.stencilWrite=this.stencilWrite,e.stencilWriteMask=this.stencilWriteMask,e.stencilFunc=this.stencilFunc,e.stencilRef=this.stencilRef,e.stencilFuncMask=this.stencilFuncMask,e.stencilFail=this.stencilFail,e.stencilZFail=this.stencilZFail,e.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(e.rotation=this.rotation),this.polygonOffset===!0&&(e.polygonOffset=!0),this.polygonOffsetFactor!==0&&(e.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(e.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(e.linewidth=this.linewidth),this.dashSize!==void 0&&(e.dashSize=this.dashSize),this.gapSize!==void 0&&(e.gapSize=this.gapSize),this.scale!==void 0&&(e.scale=this.scale),this.dithering===!0&&(e.dithering=!0),this.alphaTest>0&&(e.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(e.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(e.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(e.wireframe=this.wireframe),this.wireframeLinewidth>1&&(e.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(e.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(e.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(e.flatShading=this.flatShading),this.visible===!1&&(e.visible=!1),this.toneMapped===!1&&(e.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(e.userData=this.userData);function s(r){let n=[];for(let o in r){let a=r[o];delete a.metadata,n.push(a)}return n}if(i){let r=s(t.textures),n=s(t.images);r.length>0&&(e.textures=r),n.length>0&&(e.images=n)}return e}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.format=t.format,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let i=t.clippingPlanes,e=null;if(i!==null){let s=i.length;e=new Array(s);for(let r=0;r!==s;++r)e[r]=i[r].clone()}return this.clippingPlanes=e,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}};O.prototype.isMaterial=!0;var Et=class extends O{constructor(t){super();this.type="MeshBasicMaterial",this.color=new _(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=He,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this}};Et.prototype.isMeshBasicMaterial=!0;var F=new d,fe=new d,_t=new d,j=new d,ue=new d,Bt=new d,de=new d,tt=class{constructor(t=new d,i=new d(0,0,-1)){this.origin=t,this.direction=i}set(t,i){return this.origin.copy(t),this.direction.copy(i),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,i){return i.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,F)),this}closestPointToPoint(t,i){i.subVectors(t,this.origin);let e=i.dot(this.direction);return e<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(e).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let i=F.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(F.copy(this.direction).multiplyScalar(i).add(this.origin),F.distanceToSquared(t))}distanceSqToSegment(t,i,e,s){fe.copy(t).add(i).multiplyScalar(.5),_t.copy(i).sub(t).normalize(),j.copy(this.origin).sub(fe);let r=t.distanceTo(i)*.5,n=-this.direction.dot(_t),o=j.dot(this.direction),a=-j.dot(_t),h=j.lengthSq(),f=Math.abs(1-n*n),p,c,m,u;if(f>0)if(p=n*a-o,c=n*o-a,u=r*f,p>=0)if(c>=-u)if(c<=u){let g=1/f;p*=g,c*=g,m=p*(p+n*c+2*o)+c*(n*p+c+2*a)+h}else c=r,p=Math.max(0,-(n*c+o)),m=-p*p+c*(c+2*a)+h;else c=-r,p=Math.max(0,-(n*c+o)),m=-p*p+c*(c+2*a)+h;else c<=-u?(p=Math.max(0,-(-n*r+o)),c=p>0?-r:Math.min(Math.max(-r,-a),r),m=-p*p+c*(c+2*a)+h):c<=u?(p=0,c=Math.min(Math.max(-r,-a),r),m=c*(c+2*a)+h):(p=Math.max(0,-(n*r+o)),c=p>0?r:Math.min(Math.max(-r,-a),r),m=-p*p+c*(c+2*a)+h);else c=n>0?-r:r,p=Math.max(0,-(n*c+o)),m=-p*p+c*(c+2*a)+h;return e&&e.copy(this.direction).multiplyScalar(p).add(this.origin),s&&s.copy(_t).multiplyScalar(c).add(fe),m}intersectSphere(t,i){F.subVectors(t.center,this.origin);let e=F.dot(this.direction),s=F.dot(F)-e*e,r=t.radius*t.radius;if(s>r)return null;let n=Math.sqrt(r-s),o=e-n,a=e+n;return o<0&&a<0?null:o<0?this.at(a,i):this.at(o,i)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let i=t.normal.dot(this.direction);if(i===0)return t.distanceToPoint(this.origin)===0?0:null;let e=-(this.origin.dot(t.normal)+t.constant)/i;return e>=0?e:null}intersectPlane(t,i){let e=this.distanceToPlane(t);return e===null?null:this.at(e,i)}intersectsPlane(t){let i=t.distanceToPoint(this.origin);return i===0||t.normal.dot(this.direction)*i<0}intersectBox(t,i){let e,s,r,n,o,a,h=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,c=this.origin;return h>=0?(e=(t.min.x-c.x)*h,s=(t.max.x-c.x)*h):(e=(t.max.x-c.x)*h,s=(t.min.x-c.x)*h),f>=0?(r=(t.min.y-c.y)*f,n=(t.max.y-c.y)*f):(r=(t.max.y-c.y)*f,n=(t.min.y-c.y)*f),e>n||r>s||((r>e||e!==e)&&(e=r),(n<s||s!==s)&&(s=n),p>=0?(o=(t.min.z-c.z)*p,a=(t.max.z-c.z)*p):(o=(t.max.z-c.z)*p,a=(t.min.z-c.z)*p),e>a||o>s)||((o>e||e!==e)&&(e=o),(a<s||s!==s)&&(s=a),s<0)?null:this.at(e>=0?e:s,i)}intersectsBox(t){return this.intersectBox(t,F)!==null}intersectTriangle(t,i,e,s,r){ue.subVectors(i,t),Bt.subVectors(e,t),de.crossVectors(ue,Bt);let n=this.direction.dot(de),o;if(n>0){if(s)return null;o=1}else if(n<0)o=-1,n=-n;else return null;j.subVectors(this.origin,t);let a=o*this.direction.dot(Bt.crossVectors(j,Bt));if(a<0)return null;let h=o*this.direction.dot(ue.cross(j));if(h<0||a+h>n)return null;let f=-o*j.dot(de);return f<0?null:this.at(f/n,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};var P=new d,R=new d,me=new d,U=new d,nt=new d,ot=new d,ri=new d,ye=new d,ge=new d,Me=new d,N=class{constructor(t=new d,i=new d,e=new d){this.a=t,this.b=i,this.c=e}static getNormal(t,i,e,s){s.subVectors(e,i),P.subVectors(t,i),s.cross(P);let r=s.lengthSq();return r>0?s.multiplyScalar(1/Math.sqrt(r)):s.set(0,0,0)}static getBarycoord(t,i,e,s,r){P.subVectors(s,i),R.subVectors(e,i),me.subVectors(t,i);let n=P.dot(P),o=P.dot(R),a=P.dot(me),h=R.dot(R),f=R.dot(me),p=n*h-o*o;if(p===0)return r.set(-2,-1,-1);let c=1/p,m=(h*a-o*f)*c,u=(n*f-o*a)*c;return r.set(1-m-u,u,m)}static containsPoint(t,i,e,s){return this.getBarycoord(t,i,e,s,U),U.x>=0&&U.y>=0&&U.x+U.y<=1}static getUV(t,i,e,s,r,n,o,a){return this.getBarycoord(t,i,e,s,U),a.set(0,0),a.addScaledVector(r,U.x),a.addScaledVector(n,U.y),a.addScaledVector(o,U.z),a}static isFrontFacing(t,i,e,s){return P.subVectors(e,i),R.subVectors(t,i),P.cross(R).dot(s)<0}set(t,i,e){return this.a.copy(t),this.b.copy(i),this.c.copy(e),this}setFromPointsAndIndices(t,i,e,s){return this.a.copy(t[i]),this.b.copy(t[e]),this.c.copy(t[s]),this}setFromAttributeAndIndices(t,i,e,s){return this.a.fromBufferAttribute(t,i),this.b.fromBufferAttribute(t,e),this.c.fromBufferAttribute(t,s),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return P.subVectors(this.c,this.b),R.subVectors(this.a,this.b),P.cross(R).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return N.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return N.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,e,s,r){return N.getUV(t,this.a,this.b,this.c,i,e,s,r)}containsPoint(t){return N.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return N.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){let e=this.a,s=this.b,r=this.c,n,o;nt.subVectors(s,e),ot.subVectors(r,e),ye.subVectors(t,e);let a=nt.dot(ye),h=ot.dot(ye);if(a<=0&&h<=0)return i.copy(e);ge.subVectors(t,s);let f=nt.dot(ge),p=ot.dot(ge);if(f>=0&&p<=f)return i.copy(s);let c=a*p-f*h;if(c<=0&&a>=0&&f<=0)return n=a/(a-f),i.copy(e).addScaledVector(nt,n);Me.subVectors(t,r);let m=nt.dot(Me),u=ot.dot(Me);if(u>=0&&m<=u)return i.copy(r);let g=m*h-a*u;if(g<=0&&h>=0&&u<=0)return o=h/(h-u),i.copy(e).addScaledVector(ot,o);let M=f*u-m*p;if(M<=0&&p-f>=0&&m-u>=0)return ri.subVectors(r,s),o=(p-f)/(p-f+(m-u)),i.copy(s).addScaledVector(ri,o);let y=1/(M+g+c);return n=g*y,o=c*y,i.copy(e).addScaledVector(nt,n).addScaledVector(ot,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}};var ni=new S,at=new tt,xe=new C,H=new d,G=new d,J=new d,we=new d,be=new d,Te=new d,Dt=new d,zt=new d,Pt=new d,Nt=new A,Vt=new A,Ot=new A,Se=new d,Lt=new d,Ft=class extends I{constructor(t=new rt,i=new Et){super();this.type="Mesh",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let i=t.morphAttributes,e=Object.keys(i);if(e.length>0){let s=i[e[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=s.length;r<n;r++){let o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{let i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,i){let e=this.geometry,s=this.material,r=this.matrixWorld;if(s===void 0||(e.boundingSphere===null&&e.computeBoundingSphere(),xe.copy(e.boundingSphere),xe.applyMatrix4(r),t.ray.intersectsSphere(xe)===!1)||(ni.copy(r).invert(),at.copy(t.ray).applyMatrix4(ni),e.boundingBox!==null&&at.intersectsBox(e.boundingBox)===!1))return;let n;if(e.isBufferGeometry){let o=e.index,a=e.attributes.position,h=e.morphAttributes.position,f=e.morphTargetsRelative,p=e.attributes.uv,c=e.attributes.uv2,m=e.groups,u=e.drawRange;if(o!==null)if(Array.isArray(s))for(let g=0,M=m.length;g<M;g++){let y=m[g],w=s[y.materialIndex],x=Math.max(y.start,u.start),k=Math.min(o.count,Math.min(y.start+y.count,u.start+u.count));for(let b=x,L=k;b<L;b+=3){let xt=o.getX(b),X=o.getX(b+1),ee=o.getX(b+2);n=Rt(this,w,t,at,a,h,f,p,c,xt,X,ee),n&&(n.faceIndex=Math.floor(b/3),n.face.materialIndex=y.materialIndex,i.push(n))}}else{let g=Math.max(0,u.start),M=Math.min(o.count,u.start+u.count);for(let y=g,w=M;y<w;y+=3){let x=o.getX(y),k=o.getX(y+1),b=o.getX(y+2);n=Rt(this,s,t,at,a,h,f,p,c,x,k,b),n&&(n.faceIndex=Math.floor(y/3),i.push(n))}}else if(a!==void 0)if(Array.isArray(s))for(let g=0,M=m.length;g<M;g++){let y=m[g],w=s[y.materialIndex],x=Math.max(y.start,u.start),k=Math.min(a.count,Math.min(y.start+y.count,u.start+u.count));for(let b=x,L=k;b<L;b+=3){let xt=b,X=b+1,ee=b+2;n=Rt(this,w,t,at,a,h,f,p,c,xt,X,ee),n&&(n.faceIndex=Math.floor(b/3),n.face.materialIndex=y.materialIndex,i.push(n))}}else{let g=Math.max(0,u.start),M=Math.min(a.count,u.start+u.count);for(let y=g,w=M;y<w;y+=3){let x=y,k=y+1,b=y+2;n=Rt(this,s,t,at,a,h,f,p,c,x,k,b),n&&(n.faceIndex=Math.floor(y/3),i.push(n))}}}else e.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}};Ft.prototype.isMesh=!0;function Pi(l,t,i,e,s,r,n,o){let a;if(t.side===Le?a=e.intersectTriangle(n,r,s,!0,o):a=e.intersectTriangle(s,r,n,t.side!==Fe,o),a===null)return null;Lt.copy(o),Lt.applyMatrix4(l.matrixWorld);let h=i.ray.origin.distanceTo(Lt);return h<i.near||h>i.far?null:{distance:h,point:Lt.clone(),object:l}}function Rt(l,t,i,e,s,r,n,o,a,h,f,p){H.fromBufferAttribute(s,h),G.fromBufferAttribute(s,f),J.fromBufferAttribute(s,p);let c=l.morphTargetInfluences;if(r&&c){Dt.set(0,0,0),zt.set(0,0,0),Pt.set(0,0,0);for(let u=0,g=r.length;u<g;u++){let M=c[u],y=r[u];M!==0&&(we.fromBufferAttribute(y,h),be.fromBufferAttribute(y,f),Te.fromBufferAttribute(y,p),n?(Dt.addScaledVector(we,M),zt.addScaledVector(be,M),Pt.addScaledVector(Te,M)):(Dt.addScaledVector(we.sub(H),M),zt.addScaledVector(be.sub(G),M),Pt.addScaledVector(Te.sub(J),M)))}H.add(Dt),G.add(zt),J.add(Pt)}l.isSkinnedMesh&&(l.boneTransform(h,H),l.boneTransform(f,G),l.boneTransform(p,J));let m=Pi(l,t,i,e,H,G,J,Se);if(m){o&&(Nt.fromBufferAttribute(o,h),Vt.fromBufferAttribute(o,f),Ot.fromBufferAttribute(o,p),m.uv=N.getUV(Se,H,G,J,Nt,Vt,Ot,new A)),a&&(Nt.fromBufferAttribute(a,h),Vt.fromBufferAttribute(a,f),Ot.fromBufferAttribute(a,p),m.uv2=N.getUV(Se,H,G,J,Nt,Vt,Ot,new A));let u={a:h,b:f,c:p,normal:new d,materialIndex:0};N.getNormal(H,G,J,u.normal),m.face=u}return m}var ht,ve=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{ht===void 0&&(ht=At("canvas")),ht.width=t.width,ht.height=t.height;let e=ht.getContext("2d");t instanceof ImageData?e.putImageData(t,0,0):e.drawImage(t,0,0,t.width,t.height),i=ht}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}};var Ni=0,V=class extends vt{constructor(t=V.DEFAULT_IMAGE,i=V.DEFAULT_MAPPING,e=mt,s=mt,r=Ge,n=Je,o=Z,a=qe,h=1,f=Ze){super();Object.defineProperty(this,"id",{value:Ni++}),this.uuid=B(),this.name="",this.image=t,this.mipmaps=[],this.mapping=i,this.wrapS=e,this.wrapT=s,this.magFilter=r,this.minFilter=n,this.anisotropy=h,this.format=o,this.internalFormat=null,this.type=a,this.offset=new A(0,0),this.repeat=new A(1,1),this.center=new A(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new St,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){let i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let e={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){let s=this.image;if(s.uuid===void 0&&(s.uuid=B()),!i&&t.images[s.uuid]===void 0){let r;if(Array.isArray(s)){r=[];for(let n=0,o=s.length;n<o;n++)s[n].isDataTexture?r.push(Ie(s[n].image)):r.push(Ie(s[n]))}else r=Ie(s);t.images[s.uuid]={uuid:s.uuid,url:r}}e.image=s.uuid}return i||(t.textures[this.uuid]=e),e}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==re)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ne:t.x=t.x-Math.floor(t.x);break;case mt:t.x=t.x<0?0:1;break;case oe:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case ne:t.y=t.y-Math.floor(t.y);break;case mt:t.y=t.y<0?0:1;break;case oe:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&this.version++}};V.DEFAULT_IMAGE=void 0;V.DEFAULT_MAPPING=re;V.prototype.isTexture=!0;function Ie(l){return typeof HTMLImageElement!="undefined"&&l instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&l instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&l instanceof ImageBitmap?ve.getDataURL(l):l.data?{data:Array.prototype.slice.call(l.data),width:l.width,height:l.height,type:l.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var lt=class extends I{constructor(){super();this.type="Camera",this.matrixWorldInverse=new S,this.projectionMatrix=new S,this.projectionMatrixInverse=new S}copy(t,i){return super.copy(t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};lt.prototype.isCamera=!0;var ct=class extends lt{constructor(t=50,i=1,e=.1,s=2e3){super();this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=e,this.far=s,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let i=.5*this.getFilmHeight()/t;this.fov=yt*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(Tt*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return yt*2*Math.atan(Math.tan(Tt*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,i,e,s,r,n){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=e,this.view.offsetY=s,this.view.width=r,this.view.height=n,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,i=t*Math.tan(Tt*.5*this.fov)/this.zoom,e=2*i,s=this.aspect*e,r=-.5*s,n=this.view;if(this.view!==null&&this.view.enabled){let a=n.fullWidth,h=n.fullHeight;r+=n.offsetX*s/a,i-=n.offsetY*e/h,s*=n.width/a,e*=n.height/h}let o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+s,i,i-e,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let i=super.toJSON(t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}};ct.prototype.isPerspectiveCamera=!0;var Ut=class extends lt{constructor(t=-1,i=1,e=1,s=-1,r=.1,n=2e3){super();this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=i,this.top=e,this.bottom=s,this.near=r,this.far=n,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,i,e,s,r,n){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=e,this.view.offsetY=s,this.view.width=r,this.view.height=n,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),e=(this.right+this.left)/2,s=(this.top+this.bottom)/2,r=e-t,n=e+t,o=s+i,a=s-i;if(this.view!==null&&this.view.enabled){let h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=h*this.view.offsetX,n=r+h*this.view.width,o-=f*this.view.offsetY,a=o-f*this.view.height}this.projectionMatrix.makeOrthographic(r,n,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let i=super.toJSON(t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}};Ut.prototype.isOrthographicCamera=!0;var oi=class extends I{constructor(){super();this.type="Group"}};oi.prototype.isGroup=!0;var ai=new d,hi=new D,li=new D,Vi=new d,ci=new S,pi=class extends Ft{constructor(t,i){super(t,i);this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new S,this.bindMatrixInverse=new S}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,i){this.skeleton=t,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let t=new D,i=this.geometry.attributes.skinWeight;for(let e=0,s=i.count;e<s;e++){t.x=i.getX(e),t.y=i.getY(e),t.z=i.getZ(e),t.w=i.getW(e);let r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),i.setXYZW(e,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,i){let e=this.skeleton,s=this.geometry;hi.fromBufferAttribute(s.attributes.skinIndex,t),li.fromBufferAttribute(s.attributes.skinWeight,t),ai.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let r=0;r<4;r++){let n=li.getComponent(r);if(n!==0){let o=hi.getComponent(r);ci.multiplyMatrices(e.bones[o].matrixWorld,e.boneInverses[o]),i.addScaledVector(Vi.copy(ai).applyMatrix4(ci),n)}}return i.applyMatrix4(this.bindMatrixInverse)}};pi.prototype.isSkinnedMesh=!0;var Wt=class extends O{constructor(t){super();this.type="PointsMaterial",this.color=new _(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this}};Wt.prototype.isPointsMaterial=!0;var fi=new S,Ae=new tt,Ct=new C,jt=new d,ui=class extends I{constructor(t=new rt,i=new Wt){super();this.type="Points",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,i){let e=this.geometry,s=this.matrixWorld,r=t.params.Points.threshold,n=e.drawRange;if(e.boundingSphere===null&&e.computeBoundingSphere(),Ct.copy(e.boundingSphere),Ct.applyMatrix4(s),Ct.radius+=r,t.ray.intersectsSphere(Ct)===!1)return;fi.copy(s).invert(),Ae.copy(t.ray).applyMatrix4(fi);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(e.isBufferGeometry){let h=e.index,p=e.attributes.position;if(h!==null){let c=Math.max(0,n.start),m=Math.min(h.count,n.start+n.count);for(let u=c,g=m;u<g;u++){let M=h.getX(u);jt.fromBufferAttribute(p,M),di(jt,M,a,s,t,i,this)}}else{let c=Math.max(0,n.start),m=Math.min(p.count,n.start+n.count);for(let u=c,g=m;u<g;u++)jt.fromBufferAttribute(p,u),di(jt,u,a,s,t,i,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let i=t.morphAttributes,e=Object.keys(i);if(e.length>0){let s=i[e[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=s.length;r<n;r++){let o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{let i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};ui.prototype.isPoints=!0;function di(l,t,i,e,s,r,n){let o=Ae.distanceSqToPoint(l);if(o<i){let a=new d;Ae.closestPointToPoint(l,a),a.applyMatrix4(e);let h=s.ray.origin.distanceTo(a);if(h<s.near||h>s.far)return;r.push({distance:h,distanceToRay:Math.sqrt(o),point:a,index:t,face:null,object:n})}}var Ht=class extends I{constructor(){super();this.type="Bone"}};Ht.prototype.isBone=!0;var Gt=class extends O{constructor(t){super();this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new _(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qe,this.normalScale=new A(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this}};Gt.prototype.isMeshStandardMaterial=!0;var Jt=class extends O{constructor(t){super();this.type="LineBasicMaterial",this.color=new _(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this}};Jt.prototype.isLineBasicMaterial=!0;var mi=new d,yi=new d,gi=new S,ke=new tt,qt=new C,pt=class extends I{constructor(t=new rt,i=new Jt){super();this.type="Line",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(t.index===null){let i=t.attributes.position,e=[0];for(let s=1,r=i.count;s<r;s++)mi.fromBufferAttribute(i,s-1),yi.fromBufferAttribute(i,s),e[s]=e[s-1],e[s]+=mi.distanceTo(yi);t.setAttribute("lineDistance",new It(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,i){let e=this.geometry,s=this.matrixWorld,r=t.params.Line.threshold,n=e.drawRange;if(e.boundingSphere===null&&e.computeBoundingSphere(),qt.copy(e.boundingSphere),qt.applyMatrix4(s),qt.radius+=r,t.ray.intersectsSphere(qt)===!1)return;gi.copy(s).invert(),ke.copy(t.ray).applyMatrix4(gi);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,h=new d,f=new d,p=new d,c=new d,m=this.isLineSegments?2:1;if(e.isBufferGeometry){let u=e.index,M=e.attributes.position;if(u!==null){let y=Math.max(0,n.start),w=Math.min(u.count,n.start+n.count);for(let x=y,k=w-1;x<k;x+=m){let b=u.getX(x),L=u.getX(x+1);if(h.fromBufferAttribute(M,b),f.fromBufferAttribute(M,L),ke.distanceSqToSegment(h,f,c,p)>a)continue;c.applyMatrix4(this.matrixWorld);let X=t.ray.origin.distanceTo(c);X<t.near||X>t.far||i.push({distance:X,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}else{let y=Math.max(0,n.start),w=Math.min(M.count,n.start+n.count);for(let x=y,k=w-1;x<k;x+=m){if(h.fromBufferAttribute(M,x),f.fromBufferAttribute(M,x+1),ke.distanceSqToSegment(h,f,c,p)>a)continue;c.applyMatrix4(this.matrixWorld);let L=t.ray.origin.distanceTo(c);L<t.near||L>t.far||i.push({distance:L,point:p.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else e.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){let t=this.geometry;if(t.isBufferGeometry){let i=t.morphAttributes,e=Object.keys(i);if(e.length>0){let s=i[e[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,n=s.length;r<n;r++){let o=s[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=r}}}}else{let i=t.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}};pt.prototype.isLine=!0;var Mi=new d,xi=new d,wi=class extends pt{constructor(t,i){super(t,i);this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.isBufferGeometry)if(t.index===null){let i=t.attributes.position,e=[];for(let s=0,r=i.count;s<r;s+=2)Mi.fromBufferAttribute(i,s),xi.fromBufferAttribute(i,s+1),e[s]=s===0?0:e[s-1],e[s+1]=e[s]+Mi.distanceTo(xi);t.setAttribute("lineDistance",new It(e,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}};wi.prototype.isLineSegments=!0;var bi=class{constructor(t,i){this.array=t,this.stride=i,this.count=t!==void 0?t.length/i:0,this.usage=ti,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=B()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,i,e){t*=this.stride,e*=i.stride;for(let s=0,r=this.stride;s<r;s++)this.array[t+s]=i.array[e+s];return this}set(t,i=0){return this.array.set(t,i),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=B()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let i=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),e=new this.constructor(i,this.stride);return e.setUsage(this.usage),e}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=B()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};bi.prototype.isInterleavedBuffer=!0;var v=new d,Yt=class{constructor(t,i,e,s=!1){this.name="",this.data=t,this.itemSize=i,this.offset=e,this.normalized=s===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let i=0,e=this.data.count;i<e;i++)v.x=this.getX(i),v.y=this.getY(i),v.z=this.getZ(i),v.applyMatrix4(t),this.setXYZ(i,v.x,v.y,v.z);return this}applyNormalMatrix(t){for(let i=0,e=this.count;i<e;i++)v.x=this.getX(i),v.y=this.getY(i),v.z=this.getZ(i),v.applyNormalMatrix(t),this.setXYZ(i,v.x,v.y,v.z);return this}transformDirection(t){for(let i=0,e=this.count;i<e;i++)v.x=this.getX(i),v.y=this.getY(i),v.z=this.getZ(i),v.transformDirection(t),this.setXYZ(i,v.x,v.y,v.z);return this}setX(t,i){return this.data.array[t*this.data.stride+this.offset]=i,this}setY(t,i){return this.data.array[t*this.data.stride+this.offset+1]=i,this}setZ(t,i){return this.data.array[t*this.data.stride+this.offset+2]=i,this}setW(t,i){return this.data.array[t*this.data.stride+this.offset+3]=i,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,i,e){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=e,this}setXYZ(t,i,e,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=e,this.data.array[t+2]=s,this}setXYZW(t,i,e,s,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=i,this.data.array[t+1]=e,this.data.array[t+2]=s,this.data.array[t+3]=r,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let i=[];for(let e=0;e<this.count;e++){let s=e*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)i.push(this.data.array[s+r])}return new si(new this.array.constructor(i),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Yt(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let i=[];for(let e=0;e<this.count;e++){let s=e*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)i.push(this.data.array[s+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};Yt.prototype.isInterleavedBufferAttribute=!0;var z=class{constructor(t,i,e,s){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new i.constructor(e),this.sampleValues=i,this.valueSize=e,this.settings=null,this.DefaultSettings_={}}evaluate(t){let i=this.parameterPositions,e=this._cachedIndex,s=i[e],r=i[e-1];i:{t:{let n;e:{s:if(!(t<s)){for(let o=e+2;;){if(s===void 0){if(t<r)break s;return e=i.length,this._cachedIndex=e,this.afterEnd_(e-1,t,r)}if(e===o)break;if(r=s,s=i[++e],t<s)break t}n=i.length;break e}if(!(t>=r)){let o=i[1];t<o&&(e=2,r=o);for(let a=e-2;;){if(r===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(e===a)break;if(s=r,r=i[--e-1],t>=r)break t}n=e,e=0;break e}break i}for(;e<n;){let o=e+n>>>1;t<i[o]?n=o:e=o+1}if(s=i[e],r=i[e-1],r===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(s===void 0)return e=i.length,this._cachedIndex=e,this.afterEnd_(e-1,r,t)}this._cachedIndex=e,this.intervalChanged_(e,r,s)}return this.interpolate_(e,r,t,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let i=this.resultBuffer,e=this.sampleValues,s=this.valueSize,r=t*s;for(let n=0;n!==s;++n)i[n]=e[r+n];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};z.prototype.beforeStart_=z.prototype.copySampleValue_;z.prototype.afterEnd_=z.prototype.copySampleValue_;var Ee=class extends kt{constructor(t){super(t)}load(t,i,e,s){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let r=this,n=pe.get(t);if(n!==void 0)return r.manager.itemStart(t),setTimeout(function(){i&&i(n),r.manager.itemEnd(t)},0),n;let o=At("img");function a(){o.removeEventListener("load",a,!1),o.removeEventListener("error",h,!1),pe.add(t,this),i&&i(this),r.manager.itemEnd(t)}function h(f){o.removeEventListener("load",a,!1),o.removeEventListener("error",h,!1),s&&s(f),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",a,!1),o.addEventListener("error",h,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}};var Oi=class extends kt{constructor(t){super(t)}load(t,i,e,s){let r=new V,n=new Ee(this.manager);return n.setCrossOrigin(this.crossOrigin),n.setPath(this.path),n.load(t,function(o){r.image=o,r.needsUpdate=!0,i!==void 0&&i(r)},e,s),r}};var Ti=class extends Gt{constructor(t){super();this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new A(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ei(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.sheenTint=new _(0),this.sheenRoughness=1,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new _(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new _(1,1,1),this.specularTintMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.sheen=t.sheen,this.sheenTint.copy(t.sheenTint),this.sheenRoughness=t.sheenRoughness,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationTint.copy(t.attenuationTint),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularTint.copy(t.specularTint),this.specularTintMap=t.specularTintMap,this}};Ti.prototype.isMeshPhysicalMaterial=!0;var Si=class extends pt{constructor(t,i){super(t,i);this.type="LineLoop"}};Si.prototype.isLineLoop=!0;var Kt=class extends V{constructor(t=null,i=1,e=1,s,r,n,o,a,h=ae,f=ae,p,c){super(null,n,o,a,h,f,s,r,p,c);this.image={data:t,width:i,height:e},this.magFilter=h,this.minFilter=f,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}};Kt.prototype.isDataTexture=!0;var vi=new S,Li=new S,_e=class{constructor(t=[],i=[]){this.uuid=B(),this.bones=t.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let t=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),i.length===0)this.calculateInverses();else if(t.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,s=this.bones.length;e<s;e++)this.boneInverses.push(new S)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,i=this.bones.length;t<i;t++){let e=new S;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,i=this.bones.length;t<i;t++){let e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,i=this.bones.length;t<i;t++){let e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){let t=this.bones,i=this.boneInverses,e=this.boneMatrices,s=this.boneTexture;for(let r=0,n=t.length;r<n;r++){let o=t[r]?t[r].matrixWorld:Li;vi.multiplyMatrices(o,i[r]),vi.toArray(e,r*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new _e(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=ii(t),t=Math.max(t,4);let i=new Float32Array(t*t*4);i.set(this.boneMatrices);let e=new Kt(i,t,t,Z,Ye);return this.boneMatrices=i,this.boneTexture=e,this.boneTextureSize=t,this}getBoneByName(t){for(let i=0,e=this.bones.length;i<e;i++){let s=this.bones[i];if(s.name===t)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,i){this.uuid=t.uuid;for(let e=0,s=t.bones.length;e<s;e++){let r=t.bones[e],n=i[r];n===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),n=new Ht),this.bones.push(n),this.boneInverses.push(new S().fromArray(t.boneInverses[e]))}return this.init(),this}toJSON(){let t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;let i=this.bones,e=this.boneInverses;for(let s=0,r=i.length;s<r;s++){let n=i[s];t.bones.push(n.uuid);let o=e[s];t.boneInverses.push(o.toArray())}return t}};var q=class extends I{constructor(t,i=1){super();this.type="Light",this.color=new _(t),this.intensity=i}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let i=super.toJSON(t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}};q.prototype.isLight=!0;var Be=new d,Fi=new d,Ri=new St,W=class{constructor(t=new d(1,0,0),i=0){this.normal=t,this.constant=i}set(t,i){return this.normal.copy(t),this.constant=i,this}setComponents(t,i,e,s){return this.normal.set(t,i,e),this.constant=s,this}setFromNormalAndCoplanarPoint(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(t,i,e){let s=Be.subVectors(e,i).cross(Fi.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(s,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,i){let e=t.delta(Be),s=this.normal.dot(e);if(s===0)return this.distanceToPoint(t.start)===0?i.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/s;return r<0||r>1?null:i.copy(e).multiplyScalar(r).add(t.start)}intersectsLine(t){let i=this.distanceToPoint(t.start),e=this.distanceToPoint(t.end);return i<0&&e>0||e<0&&i>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,i){let e=i||Ri.getNormalMatrix(t),s=this.coplanarPoint(Be).applyMatrix4(t),r=this.normal.applyMatrix3(e).normalize();return this.constant=-s.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}};W.prototype.isPlane=!0;var ft=new C,Xt=new d,De=class{constructor(t=new W,i=new W,e=new W,s=new W,r=new W,n=new W){this.planes=[t,i,e,s,r,n]}set(t,i,e,s,r,n){let o=this.planes;return o[0].copy(t),o[1].copy(i),o[2].copy(e),o[3].copy(s),o[4].copy(r),o[5].copy(n),this}copy(t){let i=this.planes;for(let e=0;e<6;e++)i[e].copy(t.planes[e]);return this}setFromProjectionMatrix(t){let i=this.planes,e=t.elements,s=e[0],r=e[1],n=e[2],o=e[3],a=e[4],h=e[5],f=e[6],p=e[7],c=e[8],m=e[9],u=e[10],g=e[11],M=e[12],y=e[13],w=e[14],x=e[15];return i[0].setComponents(o-s,p-a,g-c,x-M).normalize(),i[1].setComponents(o+s,p+a,g+c,x+M).normalize(),i[2].setComponents(o+r,p+h,g+m,x+y).normalize(),i[3].setComponents(o-r,p-h,g-m,x-y).normalize(),i[4].setComponents(o-n,p-f,g-u,x-w).normalize(),i[5].setComponents(o+n,p+f,g+u,x+w).normalize(),this}intersectsObject(t){let i=t.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),ft.copy(i.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(ft)}intersectsSprite(t){return ft.center.set(0,0,0),ft.radius=.7071067811865476,ft.applyMatrix4(t.matrixWorld),this.intersectsSphere(ft)}intersectsSphere(t){let i=this.planes,e=t.center,s=-t.radius;for(let r=0;r<6;r++)if(i[r].distanceToPoint(e)<s)return!1;return!0}intersectsBox(t){let i=this.planes;for(let e=0;e<6;e++){let s=i[e];if(Xt.x=s.normal.x>0?t.max.x:t.min.x,Xt.y=s.normal.y>0?t.max.y:t.min.y,Xt.z=s.normal.z>0?t.max.z:t.min.z,s.distanceToPoint(Xt)<0)return!1}return!0}containsPoint(t){let i=this.planes;for(let e=0;e<6;e++)if(i[e].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};var Ii=new S,Ai=new d,ki=new d,et=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new A(512,512),this.map=null,this.mapPass=null,this.matrix=new S,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new De,this._frameExtents=new A(1,1),this._viewportCount=1,this._viewports=[new D(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let i=this.camera,e=this.matrix;Ai.setFromMatrixPosition(t.matrixWorld),i.position.copy(Ai),ki.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(ki),i.updateMatrixWorld(),Ii.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ii),e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),e.multiply(i.projectionMatrix),e.multiply(i.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}};var Zt=class extends et{constructor(){super(new ct(50,1,.5,500));this.focus=1}updateMatrices(t){let i=this.camera,e=yt*2*t.angle*this.focus,s=this.mapSize.width/this.mapSize.height,r=t.distance||i.far;(e!==i.fov||s!==i.aspect||r!==i.far)&&(i.fov=e,i.aspect=s,i.far=r,i.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}};Zt.prototype.isSpotLightShadow=!0;var Ei=class extends q{constructor(t,i,e=0,s=Math.PI/3,r=0,n=1){super(t,i);this.type="SpotLight",this.position.copy(I.DefaultUp),this.updateMatrix(),this.target=new I,this.distance=e,this.angle=s,this.penumbra=r,this.decay=n,this.shadow=new Zt}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}};Ei.prototype.isSpotLight=!0;var _i=new S,Mt=new d,ze=new d,Qt=class extends et{constructor(){super(new ct(90,1,.5,500));this._frameExtents=new A(4,2),this._viewportCount=6,this._viewports=[new D(2,1,1,1),new D(0,1,1,1),new D(3,1,1,1),new D(1,1,1,1),new D(3,0,1,1),new D(1,0,1,1)],this._cubeDirections=[new d(1,0,0),new d(-1,0,0),new d(0,0,1),new d(0,0,-1),new d(0,1,0),new d(0,-1,0)],this._cubeUps=[new d(0,1,0),new d(0,1,0),new d(0,1,0),new d(0,1,0),new d(0,0,1),new d(0,0,-1)]}updateMatrices(t,i=0){let e=this.camera,s=this.matrix,r=t.distance||e.far;r!==e.far&&(e.far=r,e.updateProjectionMatrix()),Mt.setFromMatrixPosition(t.matrixWorld),e.position.copy(Mt),ze.copy(e.position),ze.add(this._cubeDirections[i]),e.up.copy(this._cubeUps[i]),e.lookAt(ze),e.updateMatrixWorld(),s.makeTranslation(-Mt.x,-Mt.y,-Mt.z),_i.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_i)}};Qt.prototype.isPointLightShadow=!0;var Bi=class extends q{constructor(t,i,e=0,s=1){super(t,i);this.type="PointLight",this.distance=e,this.decay=s,this.shadow=new Qt}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}};Bi.prototype.isPointLight=!0;var $t=class extends et{constructor(){super(new Ut(-5,5,5,-5,.5,500))}};$t.prototype.isDirectionalLightShadow=!0;var Di=class extends q{constructor(t,i){super(t,i);this.type="DirectionalLight",this.position.copy(I.DefaultUp),this.updateMatrix(),this.target=new I,this.shadow=new $t}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}};Di.prototype.isDirectionalLight=!0;var Pe=class extends z{constructor(t,i,e,s){super(t,i,e,s);this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:he,endingEnd:he}}intervalChanged_(t,i,e){let s=this.parameterPositions,r=t-2,n=t+1,o=s[r],a=s[n];if(o===void 0)switch(this.getSettings_().endingStart){case le:r=t,o=2*i-e;break;case ce:r=s.length-2,o=i+s[r]-s[r+1];break;default:r=t,o=e}if(a===void 0)switch(this.getSettings_().endingEnd){case le:n=t,a=2*e-i;break;case ce:n=1,a=e+s[1]-s[0];break;default:n=t-1,a=i}let h=(e-i)*.5,f=this.valueSize;this._weightPrev=h/(i-o),this._weightNext=h/(a-e),this._offsetPrev=r*f,this._offsetNext=n*f}interpolate_(t,i,e,s){let r=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,f=this._offsetPrev,p=this._offsetNext,c=this._weightPrev,m=this._weightNext,u=(e-i)/(s-i),g=u*u,M=g*u,y=-c*M+2*c*g-c*u,w=(1+c)*M+(-1.5-2*c)*g+(-.5+c)*u+1,x=(-1-m)*M+(1.5+m)*g+.5*u,k=m*M-m*g;for(let b=0;b!==o;++b)r[b]=y*n[f+b]+w*n[h+b]+x*n[a+b]+k*n[p+b];return r}};var Ne=class extends z{constructor(t,i,e,s){super(t,i,e,s)}interpolate_(t,i,e,s){let r=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=t*o,h=a-o,f=(e-i)/(s-i),p=1-f;for(let c=0;c!==o;++c)r[c]=n[h+c]*p+n[a+c]*f;return r}};var Ve=class extends z{constructor(t,i,e,s){super(t,i,e,s)}interpolate_(t){return this.copySampleValue_(t-1)}};var T={arraySlice:function(l,t,i){return T.isTypedArray(l)?new l.constructor(l.subarray(t,i!==void 0?i:l.length)):l.slice(t,i)},convertArray:function(l,t,i){return!l||!i&&l.constructor===t?l:typeof t.BYTES_PER_ELEMENT=="number"?new t(l):Array.prototype.slice.call(l)},isTypedArray:function(l){return ArrayBuffer.isView(l)&&!(l instanceof DataView)},getKeyframeOrder:function(l){function t(s,r){return l[s]-l[r]}let i=l.length,e=new Array(i);for(let s=0;s!==i;++s)e[s]=s;return e.sort(t),e},sortedArray:function(l,t,i){let e=l.length,s=new l.constructor(e);for(let r=0,n=0;n!==e;++r){let o=i[r]*t;for(let a=0;a!==t;++a)s[n++]=l[o+a]}return s},flattenJSON:function(l,t,i,e){let s=1,r=l[0];for(;r!==void 0&&r[e]===void 0;)r=l[s++];if(r===void 0)return;let n=r[e];if(n!==void 0)if(Array.isArray(n))do n=r[e],n!==void 0&&(t.push(r.time),i.push.apply(i,n)),r=l[s++];while(r!==void 0);else if(n.toArray!==void 0)do n=r[e],n!==void 0&&(t.push(r.time),n.toArray(i,i.length)),r=l[s++];while(r!==void 0);else do n=r[e],n!==void 0&&(t.push(r.time),i.push(n)),r=l[s++];while(r!==void 0)},subclip:function(l,t,i,e,s=30){let r=l.clone();r.name=t;let n=[];for(let a=0;a<r.tracks.length;++a){let h=r.tracks[a],f=h.getValueSize(),p=[],c=[];for(let m=0;m<h.times.length;++m){let u=h.times[m]*s;if(!(u<i||u>=e)){p.push(h.times[m]);for(let g=0;g<f;++g)c.push(h.values[m*f+g])}}p.length!==0&&(h.times=T.convertArray(p,h.times.constructor),h.values=T.convertArray(c,h.values.constructor),n.push(h))}r.tracks=n;let o=1/0;for(let a=0;a<r.tracks.length;++a)o>r.tracks[a].times[0]&&(o=r.tracks[a].times[0]);for(let a=0;a<r.tracks.length;++a)r.tracks[a].shift(-1*o);return r.resetDuration(),r},makeClipAdditive:function(l,t=0,i=l,e=30){e<=0&&(e=30);let s=i.tracks.length,r=t/e;for(let n=0;n<s;++n){let o=i.tracks[n],a=o.ValueTypeName;if(a==="bool"||a==="string")continue;let h=l.tracks.find(function(y){return y.name===o.name&&y.ValueTypeName===a});if(h===void 0)continue;let f=0,p=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let c=0,m=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=m/3);let u=o.times.length-1,g;if(r<=o.times[0]){let y=f,w=p-f;g=T.arraySlice(o.values,y,w)}else if(r>=o.times[u]){let y=u*p+f,w=y+p-f;g=T.arraySlice(o.values,y,w)}else{let y=o.createInterpolant(),w=f,x=p-f;y.evaluate(r),g=T.arraySlice(y.resultBuffer,w,x)}a==="quaternion"&&new gt().fromArray(g).normalize().conjugate().toArray(g);let M=h.times.length;for(let y=0;y<M;++y){let w=y*m+c;if(a==="quaternion")gt.multiplyQuaternionsFlat(h.values,w,g,0,h.values,w);else{let x=m-c*2;for(let k=0;k<x;++k)h.values[w+k]-=g[k]}}}return l.blendMode=Xe,l}};var E=class{constructor(t,i,e,s){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=T.convertArray(i,this.TimeBufferType),this.values=T.convertArray(e,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(t){let i=t.constructor,e;if(i.toJSON!==this.toJSON)e=i.toJSON(t);else{e={name:t.name,times:T.convertArray(t.times,Array),values:T.convertArray(t.values,Array)};let s=t.getInterpolation();s!==t.DefaultInterpolation&&(e.interpolation=s)}return e.type=t.ValueTypeName,e}InterpolantFactoryMethodDiscrete(t){return new Ve(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Ne(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new Pe(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let i;switch(t){case Q:i=this.InterpolantFactoryMethodDiscrete;break;case st:i=this.InterpolantFactoryMethodLinear;break;case wt:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){let e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(e);return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Q;case this.InterpolantFactoryMethodLinear:return st;case this.InterpolantFactoryMethodSmooth:return wt}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let i=this.times;for(let e=0,s=i.length;e!==s;++e)i[e]+=t}return this}scale(t){if(t!==1){let i=this.times;for(let e=0,s=i.length;e!==s;++e)i[e]*=t}return this}trim(t,i){let e=this.times,s=e.length,r=0,n=s-1;for(;r!==s&&e[r]<t;)++r;for(;n!==-1&&e[n]>i;)--n;if(++n,r!==0||n!==s){r>=n&&(n=Math.max(n,1),r=n-1);let o=this.getValueSize();this.times=T.arraySlice(e,r,n),this.values=T.arraySlice(this.values,r*o,n*o)}return this}validate(){let t=!0,i=this.getValueSize();i-Math.floor(i)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);let e=this.times,s=this.values,r=e.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let n=null;for(let o=0;o!==r;o++){let a=e[o];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,a),t=!1;break}if(n!==null&&n>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,a,n),t=!1;break}n=a}if(s!==void 0&&T.isTypedArray(s))for(let o=0,a=s.length;o!==a;++o){let h=s[o];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,h),t=!1;break}}return t}optimize(){let t=T.arraySlice(this.times),i=T.arraySlice(this.values),e=this.getValueSize(),s=this.getInterpolation()===wt,r=t.length-1,n=1;for(let o=1;o<r;++o){let a=!1,h=t[o],f=t[o+1];if(h!==f&&(o!==1||h!==t[0]))if(s)a=!0;else{let p=o*e,c=p-e,m=p+e;for(let u=0;u!==e;++u){let g=i[p+u];if(g!==i[c+u]||g!==i[m+u]){a=!0;break}}}if(a){if(o!==n){t[n]=t[o];let p=o*e,c=n*e;for(let m=0;m!==e;++m)i[c+m]=i[p+m]}++n}}if(r>0){t[n]=t[r];for(let o=r*e,a=n*e,h=0;h!==e;++h)i[a+h]=i[o+h];++n}return n!==t.length?(this.times=T.arraySlice(t,0,n),this.values=T.arraySlice(i,0,n*e)):(this.times=t,this.values=i),this}clone(){let t=T.arraySlice(this.times,0),i=T.arraySlice(this.values,0),e=this.constructor,s=new e(this.name,t,i);return s.createInterpolant=this.createInterpolant,s}};E.prototype.TimeBufferType=Float32Array;E.prototype.ValueBufferType=Float32Array;E.prototype.DefaultInterpolation=st;var ut=class extends E{};ut.prototype.ValueTypeName="number";var Oe=class extends z{constructor(t,i,e,s){super(t,i,e,s)}interpolate_(t,i,e,s){let r=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=(e-i)/(s-i),h=t*o;for(let f=h+o;h!==f;h+=4)gt.slerpFlat(r,0,n,h-o,n,h,a);return r}};var it=class extends E{InterpolantFactoryMethodLinear(t){return new Oe(this.times,this.values,this.getValueSize(),t)}};it.prototype.ValueTypeName="quaternion";it.prototype.DefaultInterpolation=st;it.prototype.InterpolantFactoryMethodSmooth=void 0;var dt=class extends E{};dt.prototype.ValueTypeName="vector";var Y=class extends E{};Y.prototype.ValueTypeName="bool";Y.prototype.ValueBufferType=Array;Y.prototype.DefaultInterpolation=Q;Y.prototype.InterpolantFactoryMethodLinear=void 0;Y.prototype.InterpolantFactoryMethodSmooth=void 0;var te=class extends E{};te.prototype.ValueTypeName="color";var K=class extends E{};K.prototype.ValueTypeName="string";K.prototype.ValueBufferType=Array;K.prototype.DefaultInterpolation=Q;K.prototype.InterpolantFactoryMethodLinear=void 0;K.prototype.InterpolantFactoryMethodSmooth=void 0;var Ui=class{constructor(t,i=-1,e,s=Ke){this.name=t,this.tracks=e,this.duration=i,this.blendMode=s,this.uuid=B(),this.duration<0&&this.resetDuration()}static parse(t){let i=[],e=t.tracks,s=1/(t.fps||1);for(let n=0,o=e.length;n!==o;++n)i.push(Ci(e[n]).scale(s));let r=new this(t.name,t.duration,i,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){let i=[],e=t.tracks,s={name:t.name,duration:t.duration,tracks:i,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,n=e.length;r!==n;++r)i.push(E.toJSON(e[r]));return s}static CreateFromMorphTargetSequence(t,i,e,s){let r=i.length,n=[];for(let o=0;o<r;o++){let a=[],h=[];a.push((o+r-1)%r,o,(o+1)%r),h.push(0,1,0);let f=T.getKeyframeOrder(a);a=T.sortedArray(a,1,f),h=T.sortedArray(h,1,f),!s&&a[0]===0&&(a.push(r),h.push(h[0])),n.push(new ut(".morphTargetInfluences["+i[o].name+"]",a,h).scale(1/e))}return new this(t,-1,n)}static findByName(t,i){let e=t;if(!Array.isArray(t)){let s=t;e=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<e.length;s++)if(e[s].name===i)return e[s];return null}static CreateClipsFromMorphTargetSequences(t,i,e){let s={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){let h=t[o],f=h.name.match(r);if(f&&f.length>1){let p=f[1],c=s[p];c||(s[p]=c=[]),c.push(h)}}let n=[];for(let o in s)n.push(this.CreateFromMorphTargetSequence(o,s[o],i,e));return n}static parseAnimation(t,i){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let e=function(p,c,m,u,g){if(m.length!==0){let M=[],y=[];T.flattenJSON(m,M,y,u),M.length!==0&&g.push(new p(c,M,y))}},s=[],r=t.name||"default",n=t.fps||30,o=t.blendMode,a=t.length||-1,h=t.hierarchy||[];for(let p=0;p<h.length;p++){let c=h[p].keys;if(!(!c||c.length===0))if(c[0].morphTargets){let m={},u;for(u=0;u<c.length;u++)if(c[u].morphTargets)for(let g=0;g<c[u].morphTargets.length;g++)m[c[u].morphTargets[g]]=-1;for(let g in m){let M=[],y=[];for(let w=0;w!==c[u].morphTargets.length;++w){let x=c[u];M.push(x.time),y.push(x.morphTarget===g?1:0)}s.push(new ut(".morphTargetInfluence["+g+"]",M,y))}a=m.length*(n||1)}else{let m=".bones["+i[p].name+"]";e(dt,m+".position",c,"pos",s),e(it,m+".quaternion",c,"rot",s),e(dt,m+".scale",c,"scl",s)}}return s.length===0?null:new this(r,a,s,o)}resetDuration(){let t=this.tracks,i=0;for(let e=0,s=t.length;e!==s;++e){let r=this.tracks[e];i=Math.max(i,r.times[r.times.length-1])}return this.duration=i,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let i=0;i<this.tracks.length;i++)t=t&&this.tracks[i].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){let t=[];for(let i=0;i<this.tracks.length;i++)t.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Wi(l){switch(l.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ut;case"vector":case"vector2":case"vector3":case"vector4":return dt;case"color":return te;case"quaternion":return it;case"bool":case"boolean":return Y;case"string":return K}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+l)}function Ci(l){if(l.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=Wi(l.type);if(l.times===void 0){let i=[],e=[];T.flattenJSON(l.keys,i,e,"value"),l.times=i,l.values=e}return t.parse!==void 0?t.parse(l):new t(l.name,l.times,l.values,l.interpolation)}var ji=class{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let i="";for(let e=0,s=t.length;e<s;e++)i+=String.fromCharCode(t[e]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(t){let i=t.lastIndexOf("/");return i===-1?"./":t.substr(0,i+1)}};export{W as a,De as b,O as c,tt as d,N as e,Et as f,Ft as g,V as h,lt as i,ct as j,Ut as k,oi as l,pi as m,Wt as n,ui as o,Ht as p,Gt as q,Jt as r,pt as s,wi as t,bi as u,Yt as v,Kt as w,z as x,Pe as y,Ne as z,Ee as A,Oi as B,Ti as C,q as D,Si as E,_e as F,Ei as G,Bi as H,Di as I,ut as J,it as K,dt as L,Ui as M,ji as N};
